aa = <<~END
  00000000000111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
  00000001111111111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
  00000111111111111111111100000000000001111111111111111100011111100000000000000000000000000000000000011111000000000000000000000
  00011111110000000001111111000000000001111111111111111100011111100000000000000000000000000000000000011111000000000000000000000
  00111111000000000000011111100000000001111110000000000000000000000001110000000000000000000000000000111110000111000000000111000
  00111110011110000000000111110000000001111110000000000000011111100001111111111111110000000111111111111111000111111000001111110
  01111111111100000000000111110000000001111110000000000000011111100001111111111111111100001111111111111111000011111000011111100
  01111111111000000000000011110000000001111111111111110000011111100001111110000011111100011111110000111111000011111100111111000
  01111111000000000000000111110000000001111111111111110000011111100001111100000011111100011111000000011111000001111111111110000
  00111110000000000000000111110000000001111111111111110000011111100001111100000001111100011111000000011111000000111111111100000
  00111111000000000000011111100000000001111110000000000000011111100001111100000001111100011111100000111111000000011111111000000
  00011111111000000011111111000000000001111110000000000000011111100001111100000001111100001111111111111111000000001111110000000
  00000111111111111111111111110000000001111110000000000000011111100001111100000001111100000111111111111111000000001111100000000
  00000000111111111111100011111000000000111110000000000000001111100000111100000001111000000000111111001111000000011111100000000
  00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111000000000
END

colors = {
  11 => 34,
  12 => 34,
  13 => 34,
  14 => 34,
  15 => 34,
  16 => 34,
  17 => 34,
  132 => 34,
  133 => 34,
  134 => 34,
  135 => 34,
  136 => 34,
  137 => 34,
  138 => 34,
  139 => 34,
  140 => 34,
  141 => 34,
  142 => 34,
  143 => 34,
  144 => 34,
  145 => 34,
  146 => 34,
  255 => 34,
  256 => 34,
  257 => 34,
  258 => 34,
  259 => 34,
  260 => 34,
  261 => 34,
  262 => 34,
  263 => 34,
  264 => 34,
  265 => 34,
  266 => 34,
  267 => 34,
  268 => 34,
  269 => 34,
  270 => 34,
  271 => 34,
  272 => 34,
  273 => 34,
  378 => 34,
  379 => 34,
  380 => 34,
  381 => 34,
  382 => 34,
  383 => 34,
  384 => 34,
  394 => 34,
  395 => 34,
  396 => 34,
  502 => 34,
  503 => 34,
  504 => 34,
  505 => 34,
  506 => 34,
  507 => 34,
  627 => 34,
  628 => 34,
  629 => 34,
  630 => 34,
  631 => 34,
  634 => 34,
  635 => 34,
  636 => 34,
  637 => 34,
  751 => 34,
  752 => 34,
  753 => 34,
  754 => 34,
  755 => 34,
  756 => 34,
  757 => 34,
  758 => 34,
  759 => 34,
  760 => 34,
  761 => 34,
  876 => 34,
  877 => 34,
  878 => 34,
  879 => 34,
  880 => 34,
  881 => 34,
  882 => 34,
  883 => 34,
  884 => 34,
  885 => 34,
  1001 => 34,
  1002 => 34,
  1003 => 34,
  1004 => 34,
  1005 => 34,
  1006 => 34,
  1007 => 34,
  1127 => 34,
  1128 => 34,
  1129 => 34,
  1130 => 34,
  1131 => 34,
  1134 => 34,
  1252 => 34,
  1253 => 34,
  1254 => 34,
  1255 => 34,
  1256 => 34,
  1257 => 34,
  1378 => 34,
  1379 => 34,
  1380 => 34,
  1381 => 34,
  1382 => 34,
  1383 => 34,
  1384 => 34,
  1385 => 34,
  1505 => 34,
  1506 => 34,
  1507 => 34,
  1508 => 34,
  1509 => 34,
  1633 => 34,
  1634 => 34
}

blank_color = 0

start_text = 'eval$s=%w'
end_text = '.join'

aa_data = aa.split("\n")
x_length = aa_data.first.length
y_length = aa_data.length
last_point = aa_data.last.split('1').last.length # 最終行に1がないパターンは考慮しない

bits = aa.gsub("\n", '').reverse.to_i(2)

bin = [Marshal.dump(bits)].pack('m').gsub("\n", '')
color_bin = [Marshal.dump(colors.to_s.gsub(' ', ''))].pack('m').gsub("\n", '')

code = <<~CODE
  b="#{bin}"
  c="#{color_bin}"
  n=Marshal.load(b.unpack("m")[0])
  cm=eval(Marshal.load(c.unpack("m")[0]))
  e="#{start_text}"<<#{"'".ord}<<($s*3)
  o=""
  j=-1

  0.upto(#{y_length}*#{x_length}-1){|i|
    ct=cm[i]||#{blank_color}
    o<<"\e["<<ct.to_s<<"m"
    o<<((n[i]==1)?e[j+=1]:#{' '.ord})
    o<<((i%#{x_length}==(#{x_length - 1}))?#{"\n".ord}:"")
    o<<((ct==#{blank_color})?"":"\e[0m")
  }
  o[-#{last_point + end_text.length + 1},6]=""<<#{"'".ord}<<"#{end_text}"
  puts(o)
CODE

code = code.split("\n").join(';')
code << '#'

file = File.new('quine_base.rb', 'w')
file.puts "#{start_text}'#{code}'#{end_text}"
